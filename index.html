<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Pairwise Alignment</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="bootstrap/cover.css" rel="stylesheet">
    <style type="text/css">
        .dpval {
            stroke: none;
            fill: #fff;
            text-anchor:middle }
        .dpcell {
            stroke: none; }
        .dpinitcell {
            fill: #666;
            stroke: none; }
         }
    </style>

	<script src="snap/snap.svg-min.js"></script>
  </head>

  <body>
    <div class="site-wrapper">
      <div class="site-wrapper-inner">
        <div class="cover-container">
          <div class="masthead clearfix">
            <div class="inner">
              <h3 class="masthead-brand">Pairwise Alignment</h3>
			  <!-- Nav tabs -->
              <ul class="nav masthead-nav" id="myTab">
                <li class="active"><a href="#input" data-toggle="tab">Input</a></li>
                <li><a href="#result" data-toggle="tab">Result</a></li>
              </ul>
            </div>
          </div>

	<!-- Tab panes -->
	<div class="tab-content">
	  <div class="tab-pane active" id="input">
			<div class="inner cover">
			  <p class="lead">Enter two sequences that should be pairwise aligned.</p>
				<form class="form-horizontal">
					<div class="form-group">
						<label for="inputSeq1" class="control-label col-xs-2">Sequence 1</label>
						<div class="col-xs-8">
							<input type="text" class="form-control" id="inputSeq1" placeholder="e.g. ANNEALING">
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword" class="control-label col-xs-2">Sequence 2</label>
						<div class="col-xs-8">
							<input type="text" class="form-control" id="inputSeq2" placeholder="e.g. ANNUAL">
						</div>
					</div>
				</form>
			  
			  <p class="lead">
              <a onclick="compute();" href="#" class="btn btn-lg btn-default">Compute</a>
              </p>
        </div>
	  </div>
			

	<div class="tab-pane" id="result">
		<div class="inner cover">
			<svg width="100%" height="100%" id="dpmat">
			</svg>
		</div>
	</div>
	</div>
			
	<div class="mastfoot">
		<div class="inner">
			<p>Alignment applet using <a href="http://getbootstrap.com">Bootstrap</a>, by <a href="https://twitter.com/david_weese">@david_weese</a>.</p>
		</div>
	</div>	
			
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="bootstrap/bootstrap.min.js"></script>

	<script>
		$('#myTab a').click(function (e)
		{
		  e.preventDefault()
		  $(this).tab('show')
		})
		
		function align()
		{
            var s1 = inputSeq1.value;
            var s2 = inputSeq2.value;
            if (!s1.length) s1 = "ANNEALING";
            if (!s2.length) s2 = "ANNUAL";
            
            var svg = document.getElementById('dpmat');
            svg.setAttribute('viewBox', '-32 -32 ' + (s1.length * 30 + 94) + ' ' + (s2.length * 30 + 94));

            var s = Snap("#dpmat");
            s.clear();
            var maxlen = Math.max(s1.length, s2.length)

            // Initialization
            var mat = new Array(s1.length + 1);
            for (var i = 0; i <= s1.length; ++i)
            {
                mat[i] = new Array(s2.length + 1);
                mat[i][0] = i;
                var rect = s.rect(i*30+1,    1, 28, 28, 1.5, 1.5),
                    val  = s.text(i*30+15,  20, i.toString()),
                    chr  = s.text(i*30+30, -10, s1[i]);
                rect.attr({class: 'dpinitcell'});
                val.attr({class: 'dpval'});
                chr.attr({class: 'dpval'});
                s.g(rect, val);
            }
            
            for (var j = 0; j <= s2.length; ++j)
            {
                mat[0][j] = j;
                var rect = s.rect(1,   j*30+1,    28, 28, 1.5, 1.5),
                    val  = s.text(15,  j*30+20, j.toString()),
                    chr  = s.text(-15, j*30+35, s2[j]);
                rect.attr({class: 'dpinitcell'});
                val.attr({class: 'dpval'});
                chr.attr({class: 'dpval'});
                s.g(rect, val);
            }

            // Recursion
            for (var i = 1; i <= s1.length; ++i)
                for (var j = 1; j <= s2.length; ++j)
                {
                    var m = mat[i-1][j-1];
                    if (s1[i-1] != s2[j-1])
                    {
                        m = Math.min(m, mat[i][j-1], mat[i-1][j]) + 1
                    }
                    mat[i][j] = m;
                    
                    var rect = s.rect(i*30+1,    j*30+1,    28, 28, 1.5, 1.5),
                        val  = s.text(i*30+15, j*30+20, m.toString());
                    //rect.attr({class: 'dpcell', fill:"#438"});
                    rect.attr({class: 'dpcell', fill:Snap.hsl(0.4-(m/maxlen)*.4,0.3+(m/maxlen)*0.4,0.45)});
                    val.attr({class: 'dpval'});
                    s.g(rect, val);
                }
		}
			
		function compute()
		{
			$('#myTab a[href="#result"]').tab('show');
			align();
		}

	</script> 
  </body>
</html>
